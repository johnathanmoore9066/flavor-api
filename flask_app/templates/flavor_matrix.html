{% extends "base.html" %}
{% block title %}Flavor Matrix{% endblock %}

{% block content %}
<div class="container">
    <h2 class="text-center mb-4">Flavor Matrix</h2>

    <div class="search-bar text-center mb-4">
        <input type="text" class="form-control mx-auto" id="searchIngredients" placeholder="Search ingredients...">
    </div>

    <div id="ingredients-container" class="row g-4">
        {% for ingredient in ingredients %}
        <div class="col-md-4 ingredient-card-container">
            <div class="card ingredient-card" data-name="{{ ingredient.name }}" onclick="openModal('{{ ingredient.name }}')">
                <div class="card-body text-center">
                    <h4 class="ingredient-name">{{ ingredient.name }}</h4>
                    <span class="ingredient-type">{{ ingredient.type }}</span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Modal -->
    <div id="ingredient-modal" class="modal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="modal-ingredient-name" class="ingredient-name"></h4>
                    <button type="button" class="btn-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-body">
                    <span id="modal-ingredient-type" class="ingredient-type d-block mb-3"></span>
                    
                    <div class="flavor-profile-container">
                        <div class="flavor-profile">
                            {% for flavor in ['salty', 'sweet', 'sour', 'bitter', 'umami'] %}
                            <div class="profile-item">
                                <span class="label">{{ flavor.capitalize() }}</span>
                                <div class="bar-container">
                                    <div id="modal-{{ flavor }}-bar" class="bar"></div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <div class="pairings mt-4">
                        <div class="compatible">
                            <small>Pairs well with:</small>
                            <ul id="compatible-list"></ul>
                        </div>
                        <div class="ideal mt-3">
                            <small>Pairs REALLY well with:</small>
                            <ul id="ideal-list"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function openModal(ingredientName) {
    const modal = document.getElementById('ingredient-modal');
    modal.style.display = 'block';
    // Add your logic to populate modal data here
}

function closeModal() {
    const modal = document.getElementById('ingredient-modal');
    modal.style.display = 'none';
}

// Close modal when clicking outside
window.onclick = function(event) {
    const modal = document.getElementById('ingredient-modal');
    if (event.target == modal) {
        closeModal();
    }
}
</script>
{% endblock %}